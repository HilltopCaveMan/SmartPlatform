// Generated by IBatisNetModel

using System;
using System.Collections.Generic;
using System.Data;
using System.Linq;
using System.Text;

using IBatisNet.Common.Pagination;
using GInterfaceDAL.InterFace;
using GModel.InterFace;
using GDAL;
using System.Collections;

namespace GDAL.InterFace
{
    public class SendinfoyxLastDao : BaseSqlMapDao, ISendinfoyxLastDao
    {
        public IList<SendinfoyxLast> GetSendinfoLastPage(Hashtable ht)
        {
            return ExecuteQueryForList<SendinfoyxLast>("SendinfoyxLast.SelectSendinfoyxLastPageByTerNo", ht);
        }

        public string SetSendStatus(Hashtable ht)
        {
            try
            {
                IList<SendinfoyxLast> isi = ExecuteQueryForList<SendinfoyxLast>("SendinfoyxLast.SelectSendPageByTerNoAndCommand", ht);
                if (isi != null && isi.Count > 0 && isi[0].SendinfoStatus == 2)
                {
                    for (int i = 0; i < isi.Count; i++)
                    {
                        ExecuteUpdate("SendinfoyxLast.DeleteSendinfoyxLast", isi[i].Id);
                    }
                    //ExecuteUpdate("SendinfoyxLast.DeleteSendinfoyxLast", isi[0].Id);
                    return "2";
                }
                else if (isi != null && isi.Count > 0 && isi[0].SendinfoStatus == 3)
                {
                    for (int i = 0; i < isi.Count; i++)
                    {
                        ExecuteUpdate("SendinfoyxLast.DeleteSendinfoyxLast", isi[i].Id);
                    }
                    return "3";
                }
                else if (isi != null && isi.Count > 0 && isi[0].SendinfoStatus != 2)
                {
                    SendinfoyxLast sil = new SendinfoyxLast();
                    sil.Id = isi[0].Id;
                    sil.SendinfoStatus = 3;
                    ExecuteUpdate("SendinfoyxLast.UpdateSendinfoToFails", sil);
                    return "3";
                }
                else
                {
                    return "3";
                }
            }
            catch (Exception)
            {
                return "false";
            }
        }
    }
}
